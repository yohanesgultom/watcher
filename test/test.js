const assert = require('assert')
const vip = require('../vip')

describe('parseVipRates', () => {
    it('should parse rate values from vip.co.id html', () => {
        let html = `<!DOCTYPE HTML><html><head><meta charset="UTF-8"><title>VIP Money Changer and Remittance | Beranda</title><link rel="shortcut icon" href="https://www.vip.co.id/favicon.ico" /><link rel="stylesheet" type="text/css" href="https://www.vip.co.id/css/main.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700"><meta name="description" content="Pedagang valuta asing terpercaya dan berizin di Jakarta, Indonesia. Kami pastikan kurs terbaik." /><meta name="author" content="VIP Money Changer and Remittance"><meta property="og:title" content="VIP Money Changer and Remittance | Beranda"><meta property="og:description" content="Pedagang valuta asing terpercaya dan berizin di Jakarta, Indonesia. Kami pastikan kurs terbaik."><meta property="og:url" content="https://www.vip.co.id/"><meta property="og:image" content="https://www.vip.co.id/img/vip-og-logo.png"><meta property="og:site_name" content="VIP Money Changer and Remittance"><meta property="og:type" content="website"><link rel="publisher" href="https://plus.google.com/112282267448752842326"><script>      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');      ga('create', 'UA-12956153-2', 'auto');      ga('send', 'pageview');    </script></head><body><div id="wrapper"><div id="lang-selector"><a href="https://www.vip.co.id/en/">English</a> | Bahasa Indonesia</div> <div id="nav-bar"><div id="vip-logo-wrapper"><a href="https://www.vip.co.id/"><img src="https://www.vip.co.id/img/vip-logo.png" title="Beranda" alt="Beranda" width="108" height="41.12" /></a></div><a class="nav-btn-selected" href="https://www.vip.co.id/">Beranda</a><a class="nav-btn-unselected" href="https://www.vip.co.id/services">Layanan</a><a class="nav-btn-unselected" href="https://www.vip.co.id/about">Tentang Kami</a><a class="nav-btn-unselected" href="https://www.vip.co.id/contact_us">Hubungi Kami</a><a class="nav-btn-unselected" href="https://www.vip.co.id/careers">Karir</a></div><div id="content"><a id="logo-bar" title="Beranda" href="https://www.vip.co.id/">VIP Money Changer and Remittance</a><div id="main-page"><div id="mid-content"><div id="mid-content-quick-box-wrapper"><a href="https://www.vip.co.id/contact_us" id="phone-box" class="quick-box-middle " title="Telepon"><div id="mid-content-phone-logo"></div><br />(021) 3190-7777<br />(021) 390-4444</a><a href="https://www.vip.co.id/contact_us" id="address-box" class="quick-box-middle " title="Alamat"><div id="mid-content-address-logo"></div><br />Jln. Menteng Raya 23<br />Jakarta Pusat, Indonesia</a><a href="https://www.vip.co.id/faqs" id="faq-box" class="quick-box-middle " title="Pertanyaan umum"><div id="mid-content-faq-logo"></div><br />Pertanyaan<br />Umum</a><div class="main-page-clear"></div></div><div id="page-content"><img src="https://www.vip.co.id/img/vip-home-banner.png" alt="Beranda" /><h2>Selamat datang di VIP Money Changer dan Remittance!</h2>Selamat datang di situs resmi VIP Money Changer dan Remittance.Di situs ini, Anda dapat menemukan beberapa informasi tentang perusahaan kami dan Anda dapat melihatnilai tukar kami. Bila Anda memiliki pertanyaan, silakan<a href="https://www.vip.co.id/contact_us">hubungi kami</a>.</div></div><div id="right-content"><div id="hours-box" class="quick-box-right" title="Jam kerja"><div class="image-logo" id="right-content-hours-logo-open"></div><br><div id="hours-box-detail"><table><tbody><tr><td class='hours-box-day'>Sen - Jum</td><td class='hours-box-hours'>8:30 - 17:00</td></tr><tr><td class='hours-box-day'>Sab - Min</td><td class='hours-box-hours'>Tutup</td></tr></tbody></table> <br></div></div><div id="rate-box" class="quick-box-right"><span id="rate-box-text-img">Forex</span><table id="rate-table"><thead><tr><th class="rate-table-h-curr">CCY</th><th class="rate-table-h-numbers">BELI</th><th class="rate-table-h-numbers">JUAL</th></tr></thead><tbody><tr><td class="rate-table-curr" title="Dollar Australia (AUD)">AUD</td><td class="rate-table-numbers">10,215</td><td class="rate-table-numbers">10,245</td></tr><tr><td class="rate-table-curr" title="Yuan China (CNY) / Renminbi (RMB)">CNY</td><td class="rate-table-numbers">2,090</td><td class="rate-table-numbers">2,097</td></tr><tr><td class="rate-table-curr" title="Euro (EUR)">EUR</td><td class="rate-table-numbers">16,180</td><td class="rate-table-numbers">16,210</td></tr><tr><td class="rate-table-curr" title="Pound Sterling Inggris (GBP)">GBP</td><td class="rate-table-numbers">18,345</td><td class="rate-table-numbers">18,415</td></tr><tr><td class="rate-table-curr" title="Error i18n on key: rate.HKD">HKD</td><td class="rate-table-numbers">1,809</td><td class="rate-table-numbers">1,816</td></tr><tr><td class="rate-table-curr" title="Yen Jepang (JPY)">JPY</td><td class="rate-table-numbers">129.90</td><td class="rate-table-numbers">130.60</td></tr><tr><td class="rate-table-curr" title="Ringgit Malaysia (MYR)">MYR</td><td class="rate-table-numbers">3,465</td><td class="rate-table-numbers">3,485</td></tr><tr><td class="rate-table-curr" title="Real Saudi Arabia (SAR)">SAR</td><td class="rate-table-numbers">3,785</td><td class="rate-table-numbers">3,805</td></tr><tr><td class="rate-table-curr" title="Dollar Singapura (SGD)">SGD</td><td class="rate-table-numbers">10,475</td><td class="rate-table-numbers">10,495</td></tr><tr><td class="rate-table-curr" title="Dollar Amerika Serikat (USD)">USD</td><td class="rate-table-numbers">14,150</td><td class="rate-table-numbers">14,190</td></tr></tbody></table><br><a>18-Jan 17:00</a></div> <div id="share-box" class="quick-box-right" title="Jejaring sosial"><div class="image-logo" id="right-content-share-logo"></div><br><a href="https://twitter.com/VIPMoneyChanger" id="twitter-logo" class="quick-box-3p-logo" title="Twitter @VIPMoneyChanger" target="_blank"><div></div></a><a href="https://www.facebook.com/vipmoneychanger" id="facebook-logo" class="quick-box-3p-logo" title="Facebook VIP Money Changer" target="_blank"><div></div></a><a href="https://plus.google.com/+vipmoneychanger/" id="google-place-logo" class="quick-box-3p-logo" title="Google Place VIP Money Changer" target="_blank"><div></div></a></div> </div><div class="main-page-clear"></div></div><div id="footer">&copy; 2019 VIP Money Changer.</div></div></div></body></html>`;
        let expected = [
            { id: 'AUD', buy: 10215, sell: 10245, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'CNY', buy: 2090, sell: 2097, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'EUR', buy: 16180, sell: 16210, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'GBP', buy: 18345, sell: 18415, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'HKD', buy: 1809, sell: 1816, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'JPY', buy: 129.9, sell: 130.6, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'MYR', buy: 3465, sell: 3485, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'SAR', buy: 3785, sell: 3805, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'SGD', buy: 10475, sell: 10495, created_at: "2019-01-18T00:00:00.000Z" },
            { id: 'USD', buy: 14150, sell: 14190, created_at: "2019-01-18T00:00:00.000Z" }
        ]
        let actual = vip.parseVipRates(html, new Date('2019-01-18'))
        assert.deepEqual(actual, expected)
    })
})
